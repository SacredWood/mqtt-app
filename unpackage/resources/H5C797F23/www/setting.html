<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>控制页</title>
    <link rel="stylesheet" href="css/reset.css">
    <link rel="stylesheet" href="css/setting.css">
    <script src="js/jquery-3.4.1.min.js"></script>
</head>

<body>
    <div class="header">
        <img src="img/logo.jpg" alt="">
    </div>
    <div class="content">
        <label for="ProductKey">
      产品密钥
      <input type="text" name="ProductKey" id="ProductKey" placeholder="ProductKey">
    </label>
        <label for="DeviceName">
      设备名称
      <input type="text" name="DeviceName" id="DeviceName" placeholder="DeviceName">
    </label>
        <label for="DeviceSecret">
      设备密钥
      <input type="text" name="DeviceSecret" id="DeviceSecret" placeholder="DeviceSecret">
    </label>
        <label for="Topic">
      订阅主题
      <input type="text" name="Topic" id="Topic"  placeholder="Topic">
    </label>
        <div class="btn-set">
            <button class="btn save" onclick="save()">保存</button>
            <button class="btn clear" onclick="clear()">清空</button>
            <button class="btn select" onclick="select()">选择</button>
        </div>
		 <div class="btn-set">
		    <button class="btn connection" onclick="connection()">连接</button>
		    <button class="btn control" onclick="control()">控制</button>
		</div>
    </div>
    <div class="footer">
    </div>
    <script>
        function save() {
            localStorage.setItem('$ProductKey', $('#ProductKey').val());
            localStorage.setItem('$DeviceName', $('#DeviceName').val());
            localStorage.setItem('$DeviceSecret', $('#DeviceSecret').val());
            localStorage.setItem('$Topic', $('#Topic').val());
            console.log('save', '保存成功');
			var obj = JSON.parse(localStorage.getItem('$DeviceList')) || {};
			obj[`${$('#DeviceName').val()}&${$('#Topic').val()}`] = {
				ProductKey:$('#ProductKey').val(),
				DeviceName:$('#DeviceName').val(),
				DeviceSecret:$('#DeviceSecret').val(),
				Topic:$('#Topic').val(),
			};
			localStorage.setItem('$DeviceList', JSON.stringify(obj));
            alert('保存成功');
        }

        function clear() {
            localStorage.setItem('$ProductKey', '');
            localStorage.setItem('$DeviceName', '');
            localStorage.setItem('$DeviceSecret', '');
            localStorage.setItem('$Topic', '');
            $('#ProductKey').val('')
            $('#DeviceName').val('')
            $('#DeviceSecret').val('')
            $('#Topic').val('')
            console.log('clear', '清除成功');
            alert('清除成功');
        }

        function connection() {
            window.location.href = 'connect.html';
        }

        function control() {
            window.location.href = 'control.html';
        }
		 function select() {
		    window.location.href = 'list.html';
		}
    </script>
</body>

</html>